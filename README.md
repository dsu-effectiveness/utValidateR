
<!-- README.md is generated from README.Rmd. Please edit that file -->

# utValidateR <img src="man/figures/README-ut_ie_logo.png" align="right" width="120" />

<!-- badges: start -->

[![Lifecycle:
experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
<!-- badges: end -->

The goal of utValidateR is to validate elements within the warehouse ETL
pipeline, or elements in the reporting layer. The functions in this
library are used in USHE and IPEDS reporting. The functions also for the
basis for the campus data audits.

## Installation

You can install the development version of utValidateR from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("dsu-effectiveness/utValidateR")
```

## Fake data set

`utValidateR` contains a simulated data set. This data simulates the
structure of the data pulled from the data warehouse when submitting the
Student file to USHE. Use this data set to test your validation
functions. The dataset loads automatically when you load the
`utValidateR` package.

``` r
library(DT)
View(head(fake_student_df))
```

## Using

``` r
library(utValidateR)
library(dplyr)
#> 
#> Attaching package: 'dplyr'
#> The following objects are masked from 'package:stats':
#> 
#>     filter, lag
#> The following objects are masked from 'package:base':
#> 
#>     intersect, setdiff, setequal, union
data("fake_student_df")
data("checklist")

check_result <- do_checks(fake_student_df, checklist)
#> [1] "!is_duplicated(student_id)"
#> [1] "!is_duplicated(ssn)"
#> [1] "!is.na(student_id) & !is.na(ssn)"
#> [1] "!is.na(ssn)"
#> [1] "(us_citizenship_code != 1) | !is.na(ssn)"
#> [1] "matches_regex(ssn, ssn_regex)"
#> [1] "!is.na(last_name)"
#> [1] "!has_nonalpha(last_name)"
#> [1] "!is.na(first_name)"
#> [1] "!has_nonalpha(first_name)"
#> [1] "is.na(middle_name) | !has_nonalpha(middle_name)"
#> [1] "is.na(previous_last_name) | !has_nonalpha(previous_last_name)"
#> [1] "is.na(previous_first_name) | !has_nonalpha(previous_first_name)"
#> [1] "!is.na(local_address_zip_code)"
#> [1] "!is.na(us_citizenship_code)"
#> [1] "!is.na(first_admit_country_code)"
#> Warning in get_activity_dates(df_tocheck, datecol = .x, rule = .y): Could not
#> find column spbpers_activity_date

#> Warning in get_activity_dates(df_tocheck, datecol = .x, rule = .y): Could not
#> find column spbpers_activity_date

#> Warning in get_activity_dates(df_tocheck, datecol = .x, rule = .y): Could not
#> find column spbpers_activity_date

#> Warning in get_activity_dates(df_tocheck, datecol = .x, rule = .y): Could not
#> find column spbpers_activity_date

#> Warning in get_activity_dates(df_tocheck, datecol = .x, rule = .y): Could not
#> find column spbpers_activity_date
#> Warning in get_activity_dates(df_tocheck, datecol = .x, rule = .y): Could not
#> find column spraddr_activity_date
#> Warning in get_activity_dates(df_tocheck, datecol = .x, rule = .y): Could not
#> find column spbpers_activity_date
glimpse(check_result)
#> Rows: 10,000
#> Columns: 88
#> $ ssn                                     <chr> "991-59-3442", "066-26-2729", …
#> $ first_name                              <chr> "Justine", "Bryant", "Cher", "…
#> $ last_name                               <chr> "Daniel", "Pagac", "Hauck", "G…
#> $ middle_name                             <chr> NA, NA, NA, NA, "Bob", NA, NA,…
#> $ previous_last_name                      <chr> NA, NA, "Jones", "Jones", "Jon…
#> $ previous_first_name                     <chr> NA, NA, NA, NA, NA, "Danny", N…
#> $ preferred_first_name                    <chr> "Joe", NA, "Joe", "Deb", "Joe"…
#> $ preferred_middle_name                   <chr> NA, NA, NA, NA, NA, NA, NA, NA…
#> $ local_address_zip_code                  <chr> "13979-8912", "96921-0688", "8…
#> $ mailing_address_zip_code                <chr> "13074-7031", "37697-2663", "6…
#> $ us_citizenship_code                     <chr> "3", "9", NA, "4", "4", "4", "…
#> $ first_admit_county_code                 <chr> "11", "53", "15", "39", "49", …
#> $ first_admit_state_code                  <chr> "UT", "UT", "UT", "UT", "UT", …
#> $ first_admit_country_code                <chr> "US", "US", "US", "CS", "US", …
#> $ residential_housing_code                <chr> "M", "0", "S", "R", "M", "N", …
#> $ student_id                              <chr> "00712652", "00550034", "00259…
#> $ previous_student_id                     <lgl> NA, NA, NA, NA, NA, NA, NA, NA…
#> $ birth_date                              <date> 2003-02-04, 2018-08-27, 1978-…
#> $ gender_code                             <chr> "F", "M", "F", "F", "M", "M", …
#> $ is_hispanic_latino_ethnicity            <lgl> TRUE, TRUE, FALSE, FALSE, FALS…
#> $ is_asian                                <lgl> TRUE, FALSE, FALSE, TRUE, TRUE…
#> $ is_black                                <lgl> FALSE, TRUE, TRUE, FALSE, FALS…
#> $ is_american_indian_alaskan              <lgl> FALSE, TRUE, FALSE, TRUE, TRUE…
#> $ is_hawaiian_pacific_islander            <lgl> TRUE, FALSE, TRUE, TRUE, FALSE…
#> $ is_white                                <lgl> TRUE, FALSE, TRUE, FALSE, TRUE…
#> $ is_international                        <lgl> TRUE, TRUE, FALSE, FALSE, FALS…
#> $ is_other_race                           <lgl> FALSE, FALSE, FALSE, TRUE, TRU…
#> $ primary_major_cip_code                  <chr> "93947", "42064", "43531", "53…
#> $ student_type_code                       <chr> "5", "0", "0", "5", "C", "1", …
#> $ primary_level_class_id                  <chr> "SR", "SR", "JR", NA, "FR", "S…
#> $ primary_degree_id                       <chr> "BM", "BSN", NA, "BIS", "BS", …
#> $ institutional_cumulative_credits_earned <dbl> 84.0, 25.5, 109.0, 83.0, 115.3…
#> $ institutional_cumulative_gpa            <dbl> 2.88, 3.35, 2.41, 2.85, 2.54, …
#> $ full_time_part_time_code                <chr> "F", "F", "F", "P", "F", "F", …
#> $ transfer_cumulative_credits_earned      <dbl> 45.0, 159.0, NA, 185.0, 119.0,…
#> $ secondary_major_cip_code                <chr> "99407", "35353", "08267", "09…
#> $ act_composite_score                     <int> 21, 36, 7, 30, 32, 33, 16, 1, …
#> $ act_english_score                       <int> 22, 17, 24, 24, 4, 28, 36, 16,…
#> $ act_math_score                          <int> 14, 23, 10, 12, 24, 32, 30, 22…
#> $ act_reading_score                       <int> 4, 8, 32, 28, 2, 6, 33, 12, 19…
#> $ act_science_score                       <int> 35, 14, 1, 19, 12, 14, 11, 34,…
#> $ high_school_graduation_date             <date> 2015-12-05, 2011-10-17, 1991-…
#> $ is_pell_eligible                        <lgl> TRUE, NA, FALSE, TRUE, FALSE, …
#> $ is_pell_awarded                         <lgl> TRUE, FALSE, TRUE, FALSE, TRUE…
#> $ is_bia                                  <lgl> TRUE, TRUE, FALSE, TRUE, FALSE…
#> $ primary_major_college_id                <chr> "HS", "HO", "MA", "HO", "NU", …
#> $ primary_major_college_desc              <chr> "Coll of Sci, Engr & Tech", "C…
#> $ secondary_major_college_id              <chr> "HI", "ED", "EF", "ED", "FA", …
#> $ secondary_major_college_desc            <chr> "Coll of Sci, Engr & Tech", "M…
#> $ level_id                                <chr> "00", "GR", "UG", "NC", "UG", …
#> $ term_id                                 <dbl> 201420, 201440, 201440, 202020…
#> $ sgbstdn_activity_date                   <date> 2020-12-24, 2021-06-28, 2020-…
#> $ spriden_activity_date                   <date> 2020-08-15, 2021-03-25, 2021-…
#> $ sabsupl_activity_date                   <date> 2018-09-27, 2018-10-02, 2020-…
#> $ S00a_activity_date                      <date> 2020-08-15, 2021-03-25, 2021-…
#> $ S00a_error_age                          <dbl> 698, 476, 415, 1463, 567, 313,…
#> $ S00a_status                             <chr> "Pass", "Pass", "Pass", "Pass"…
#> $ S00b_status                             <chr> "Pass", "Pass", "Pass", "Pass"…
#> $ S03a_status                             <chr> "Pass", "Pass", "Pass", "Pass"…
#> $ S03b_status                             <chr> "Pass", "Pass", "Pass", "Pass"…
#> $ S03c_status                             <chr> "Pass", "Pass", "Pass", "Pass"…
#> $ S04b_status                             <chr> "Failure", "Pass", "Pass", "Pa…
#> $ S06a_activity_date                      <date> 2020-08-15, 2021-03-25, 2021-…
#> $ S06a_error_age                          <dbl> 698, 476, 415, 1463, 567, 313,…
#> $ S06a_status                             <chr> "Pass", "Pass", "Pass", "Pass"…
#> $ S06b_activity_date                      <date> 2020-08-15, 2021-03-25, 2021-…
#> $ S06b_error_age                          <dbl> 698, 476, 415, 1463, 567, 313,…
#> $ S06b_status                             <chr> "Pass", "Pass", "Pass", "Pass"…
#> $ S06c_activity_date                      <date> 2020-08-15, 2021-03-25, 2021-…
#> $ S06c_error_age                          <dbl> 698, 476, 415, 1463, 567, 313,…
#> $ S06c_status                             <chr> "Pass", "Pass", "Pass", "Pass"…
#> $ S06d_activity_date                      <date> 2020-08-15, 2021-03-25, 2021-…
#> $ S06d_error_age                          <dbl> 698, 476, 415, 1463, 567, 313,…
#> $ S06d_status                             <chr> "Pass", "Pass", "Pass", "Pass"…
#> $ S06e_activity_date                      <date> 2020-08-15, 2021-03-25, 2021-…
#> $ S06e_error_age                          <dbl> 698, 476, 415, 1463, 567, 313,…
#> $ S06e_status                             <chr> "Pass", "Pass", "Pass", "Pass"…
#> $ S07a_activity_date                      <date> 2020-08-15, 2021-03-25, 2021-…
#> $ S07a_error_age                          <dbl> 698, 476, 415, 1463, 567, 313,…
#> $ S07a_status                             <chr> "Pass", "Pass", "Pass", "Pass"…
#> $ S07b_activity_date                      <date> 2020-08-15, 2021-03-25, 2021-…
#> $ S07b_error_age                          <dbl> 698, 476, 415, 1463, 567, 313,…
#> $ S07b_status                             <chr> "Pass", "Pass", "Pass", "Pass"…
#> $ S08a_status                             <chr> "Pass", "Pass", "Pass", "Pass"…
#> $ S09a_status                             <chr> "Pass", "Pass", "Failure", "Pa…
#> $ S10a_activity_date                      <date> 2018-09-27, 2018-10-02, 2020-…
#> $ S10a_error_age                          <dbl> 1386, 1381, 828, 485, 783, 143…
#> $ S10a_status                             <chr> "Pass", "Pass", "Pass", "Pass"…
```
