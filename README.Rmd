---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# utValidateR <img src="man/figures/README-ut_ie_logo.png" align="right" width="120" />

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
<!-- badges: end -->

The goal of utValidateR is to validate elements within the warehouse ETL pipeline, or elements in the reporting layer. The functions in this library are used in USHE and IPEDS reporting. The functions also for the basis for the campus data audits. 

## Installation

You can install the development version of utValidateR from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("dsu-effectiveness/utValidateR", ref = "develop")
```

## Fake data set

`utValidateR` contains a simulated data set. This data simulates the structure of the data pulled from the data warehouse when submitting the Student file to USHE. Use this data set to test your validation functions. The dataset loads automatically when you load the `utValidateR` package.


```r
library(DT)
View(head(fake_student_df))
```

## Using

The following is an example of applying `do_checks()` to the supplied `fake_student_df` dataset. Further examples and orientation are provided in vignettes/database-checks.Rmd, which (if installed with `build_vignettes = TRUE`) can be view via `vignette("database-checks")`.

```{r}
library(utValidateR)
library(dplyr)
data("fake_student_df")
data("checklist")
data("aux_info")

student_checks <- filter(checklist, file == "Student", type == "Database") %>% 
  glimpse()

student_check_result <- suppressMessages(suppressWarnings( # suppressing rather verbose error descriptions
  do_checks(df_tocheck = fake_student_df, 
            checklist = student_checks, 
            aux_info = aux_info)
))

glimpse(student_check_result)
```

## Contributing

Changes to the R code for performing each rule check should be made in data-raw/checklist.R, in the `rule_spec` object. Functions used by these checks are defined in R/checker-helpers.R. Data objects referenced in the checker functions are provided in `aux_info`, which can be modified in data-raw/aux_info.R. 
